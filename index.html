<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="format-detection" content="telephone=no">
    <link rel="manifest" href="/manifest.webmanifest">
    <link rel="icon" href="/logo.png" type="image/png">
    <meta name="theme-color" content="#3390ec">
    
    <!-- Prevent caching for development -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <title>–ü—Ä–æ—Ä–∞–±360</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function () {
        // Initialize Telegram Web App
        if (window.Telegram && window.Telegram.WebApp) {
            const tg = window.Telegram.WebApp;
            
            // Enable closing confirmation
            tg.enableClosingConfirmation();
            
            // Set viewport height for mobile browsers with stabilization
            const setViewportHeight = () => {
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                document.documentElement.style.setProperty('--real-vh', `${window.innerHeight}px`);
                document.documentElement.style.setProperty('--safe-area-inset-top', 'env(safe-area-inset-top)');
                document.documentElement.style.setProperty('--safe-area-inset-bottom', 'env(safe-area-inset-bottom)');
            };
            
            setViewportHeight();
            window.addEventListener('resize', setViewportHeight);
            window.addEventListener('orientationchange', () => {
                // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –ø–æ—Å–ª–µ –ø–æ–≤–æ—Ä–æ—Ç–∞
                setTimeout(setViewportHeight, 100);
            });
            
            // Pull-to-refresh –æ—Ç–∫–ª—é—á–µ–Ω –ø–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            
            // Initialize the app
            tg.ready();
        } else {
            // Fallback for non-Telegram browsers
            console.log('Telegram WebApp not available, using fallback');
            
            // Set viewport height for mobile browsers with stabilization
            const setViewportHeight = () => {
                const vh = window.innerHeight * 0.01;
                document.documentElement.style.setProperty('--vh', `${vh}px`);
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö –±—Ä–∞—É–∑–µ—Ä–æ–≤
                document.documentElement.style.setProperty('--real-vh', `${window.innerHeight}px`);
                document.documentElement.style.setProperty('--safe-area-inset-top', 'env(safe-area-inset-top)');
                document.documentElement.style.setProperty('--safe-area-inset-bottom', 'env(safe-area-inset-bottom)');
            };
            
            setViewportHeight();
            window.addEventListener('resize', setViewportHeight);
            window.addEventListener('orientationchange', () => {
                // –ó–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –ø–æ—Å–ª–µ –ø–æ–≤–æ—Ä–æ—Ç–∞
                setTimeout(setViewportHeight, 100);
            });
            
            // Pull-to-refresh –æ—Ç–∫–ª—é—á–µ–Ω –ø–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        }
    });
    </script>

</head>
<body>
    <div id="root"></div>
    <script>
      // –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞
      console.log('üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∫—Ä–æ–ª–ª–∏–Ω–≥–∞:');
      console.log('- document.body.style.position:', document.body.style.position);
      console.log('- document.body.style.overflow:', document.body.style.overflow);
      console.log('- document.body.style.height:', document.body.style.height);
      console.log('- window.innerHeight:', window.innerHeight);
      console.log('- document.documentElement.scrollHeight:', document.documentElement.scrollHeight);
      
      // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ —Å–∫—Ä–æ–ª–ª
      setTimeout(() => {
        const hasScroll = document.documentElement.scrollHeight > window.innerHeight;
        console.log('üìè –ï—Å—Ç—å –ª–∏ —Å–∫—Ä–æ–ª–ª:', hasScroll);
        console.log('üìè –í—ã—Å–æ—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞:', document.documentElement.scrollHeight);
        console.log('üìè –í—ã—Å–æ—Ç–∞ –æ–∫–Ω–∞:', window.innerHeight);
      }, 1000);

      // –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º Service Worker —Ç–æ–ª—å–∫–æ –≤–Ω–µ localhost, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –≤ dev
      (function registerSW() {
        try {
          const isLocal = /localhost|127\.0\.0\.1|::1/.test(location.hostname);
          if (!('serviceWorker' in navigator) || isLocal) return;
          window.addEventListener('load', function() {
            navigator.serviceWorker.register('/sw.js').then(function(registration) {
              console.log('SW registered');
              // –ù–µ —Ñ–æ—Ä—Å–∏—Ä—É–µ–º –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ SW –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ,
              // —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —Ü–∏–∫–ª—ã –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏.
            }).catch(function(err){
              console.warn('SW registration failed', err);
            });
          });
        } catch (e) {
          console.warn('SW registration skipped:', e);
        }
      })();
    </script>
    <script type="module" src="src/index.tsx"></script>
</body>
</html>
